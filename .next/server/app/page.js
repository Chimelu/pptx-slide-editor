(()=>{var e={};e.id=931,e.ids=[931],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9561:e=>{"use strict";e.exports=require("canvas")},4681:e=>{"use strict";e.exports=require("jsdom")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},6111:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>f,originalPathname:()=>u,pages:()=>d,routeModule:()=>g,tree:()=>c});var n=r(482),o=r(9108),s=r(2563),l=r.n(s),i=r(8300),a={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>i[e]);r.d(t,a);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1136)),"/Users/chukaezeoguine/Desktop/pptx-slide-editor/src/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,1342)),"/Users/chukaezeoguine/Desktop/pptx-slide-editor/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/chukaezeoguine/Desktop/pptx-slide-editor/src/app/page.tsx"],u="/page",f={require:r,loadChunk:()=>Promise.resolve()},g=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5891:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},821:(e,t,r)=>{Promise.resolve().then(r.bind(r,4669))},2004:(e,t,r)=>{Promise.resolve().then(r.bind(r,815))},2295:(e,t,r)=>{"use strict";e.exports=r(6372).vendored["react-ssr"].ReactJsxRuntime},80:(e,t,r)=>{"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(3729);"function"==typeof Object.is&&Object.is,n.useState,n.useEffect,n.useLayoutEffect,n.useDebugValue,t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:function(e,t){return t()}},7986:(e,t,r)=>{"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(3729),o=r(8145),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},l=o.useSyncExternalStore,i=n.useRef,a=n.useEffect,c=n.useMemo,d=n.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var u=i(null);if(null===u.current){var f={hasValue:!1,value:null};u.current=f}else f=u.current;var g=l(e,(u=c(function(){function e(e){if(!a){if(a=!0,l=e,e=n(e),void 0!==o&&f.hasValue){var t=f.value;if(o(t,e))return i=t}return i=e}if(t=i,s(l,e))return t;var r=n(e);return void 0!==o&&o(t,r)?(l=e,t):(l=e,i=r)}var l,i,a=!1,c=void 0===r?null:r;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,r,n,o]))[0],u[1]);return a(function(){f.hasValue=!0,f.value=g},[g]),d(g),g}},8145:(e,t,r)=>{"use strict";e.exports=r(80)},4657:(e,t,r)=>{"use strict";e.exports=r(7986)},815:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var n,o=r(2295),s=r(3729);class l{static{this.baseUrl="/api/pptx"}static async parsePPTX(e){let t=new FormData;t.append("file",e);let r=await fetch(`${this.baseUrl}/parse`,{method:"POST",body:t});if(!r.ok)throw Error(`Failed to parse PPTX: ${r.statusText}`);return r.json()}static async getSlide(e){let t=await fetch(`${this.baseUrl}/slides/${e}`);if(!t.ok)throw Error(`Failed to get slide: ${t.statusText}`);return t.json()}static async exportPPTX(e){let t=await fetch(`${this.baseUrl}/export`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationData:e})});if(!t.ok)throw Error(`Failed to export PPTX: ${t.statusText}`);return t.blob()}}let i=e=>{let t;let r=new Set,n=(e,n)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=n?n:"object"!=typeof o||null===o)?o:Object.assign({},t,o),r.forEach(r=>r(t,e))}},o=()=>t,s={setState:n,getState:o,getInitialState:()=>l,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},l=t=e(n,o,s);return s},a=e=>e?i(e):i;var c=r(4657);let{useDebugValue:d}=s,{useSyncExternalStoreWithSelector:u}=c,f=!1,g=e=>e,p=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?a(e):e,r=(e,r)=>(function(e,t=g,r){r&&!f&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),f=!0);let n=u(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return d(n),n})(t,e,r);return Object.assign(r,t),r},h=new Map,x=e=>{let t=h.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([e,t])=>[e,t.getState()])):{}},m=(e,t,r)=>{if(void 0===e)return{type:"untracked",connection:t.connect(r)};let n=h.get(r.name);if(n)return{type:"tracked",store:e,...n};let o={connection:t.connect(r),stores:{}};return h.set(r.name,o),{type:"tracked",store:e,...o}},b=(e,t)=>{let r;try{r=JSON.parse(e)}catch(e){console.error("[zustand devtools middleware] Could not parse the received json",e)}void 0!==r&&t(r)},y=(n?p(n):p)(((e,t={})=>(r,n,o)=>{let s;let{enabled:l,anonymousActionType:i,store:a,...c}=t;try{s=(null==l||l)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(e){}if(!s)return l&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),e(r,n,o);let{connection:d,...u}=m(a,s,c),f=!0;o.setState=(e,t,s)=>{let l=r(e,t);if(!f)return l;let u=void 0===s?{type:i||"anonymous"}:"string"==typeof s?{type:s}:s;return void 0===a?null==d||d.send(u,n()):null==d||d.send({...u,type:`${a}/${u.type}`},{...x(c.name),[a]:o.getState()}),l};let g=(...e)=>{let t=f;f=!1,r(...e),f=t},p=e(o.setState,n,o);if("untracked"===u.type?null==d||d.init(p):(u.stores[u.store]=o,null==d||d.init(Object.fromEntries(Object.entries(u.stores).map(([e,t])=>[e,e===u.store?p:t.getState()])))),o.dispatchFromDevtools&&"function"==typeof o.dispatch){let e=!1,t=o.dispatch;o.dispatch=(...r)=>{"__setState"!==r[0].type||e||(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),e=!0),t(...r)}}return d.subscribe(e=>{var t;switch(e.type){case"ACTION":if("string"!=typeof e.payload){console.error("[zustand devtools middleware] Unsupported action format");return}return b(e.payload,e=>{if("__setState"===e.type){if(void 0===a){g(e.state);return}1!==Object.keys(e.state).length&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let t=e.state[a];if(null==t)return;JSON.stringify(o.getState())!==JSON.stringify(t)&&g(t);return}o.dispatchFromDevtools&&"function"==typeof o.dispatch&&o.dispatch(e)});case"DISPATCH":switch(e.payload.type){case"RESET":if(g(p),void 0===a)return null==d?void 0:d.init(o.getState());return null==d?void 0:d.init(x(c.name));case"COMMIT":if(void 0===a){null==d||d.init(o.getState());break}return null==d?void 0:d.init(x(c.name));case"ROLLBACK":return b(e.state,e=>{if(void 0===a){g(e),null==d||d.init(o.getState());return}g(e[a]),null==d||d.init(x(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return b(e.state,e=>{if(void 0===a){g(e);return}JSON.stringify(o.getState())!==JSON.stringify(e[a])&&g(e[a])});case"IMPORT_STATE":{let{nextLiftedState:r}=e.payload,n=null==(t=r.computedStates.slice(-1)[0])?void 0:t.state;if(!n)return;void 0===a?g(n):g(n[a]),null==d||d.send(null,r);break}case"PAUSE_RECORDING":return f=!f}return}}),p})((e,t)=>({document:null,currentSlideIndex:0,selectedObjects:[],zoom:1,pan:{x:0,y:0},history:{past:[],future:[]},isEditing:!1,gridSnap:!0,objectSnap:!0,get canUndo(){return t().history.past.length>0},get canRedo(){return t().history.future.length>0},setDocument:r=>{e({document:r,currentSlideIndex:0,selectedObjects:[]}),t().saveToHistory()},setCurrentSlide:r=>{let{document:n}=t();n&&r>=0&&r<n.slides.length&&e({currentSlideIndex:r,selectedObjects:[]})},selectObjects:t=>{e({selectedObjects:t})},updateObject:(r,n)=>{let{document:o}=t();if(o){let s={...o},l=s.slides[t().currentSlideIndex],i=l.objects.findIndex(e=>e.id===r);-1!==i&&(l.objects[i]={...l.objects[i],...n},e({document:s}))}},moveObjects:(r,n)=>{let{document:o}=t();if(o){let s={...o};s.slides[t().currentSlideIndex].objects.forEach(e=>{r.includes(e.id)&&e.transform&&(e.transform.left+=n.x,e.transform.top+=n.y)}),e({document:s})}},resizeObject:(e,r,n)=>{let{document:o}=t();if(o){let s=o.slides[t().currentSlideIndex].objects.find(t=>t.id===e);s&&s.transform&&t().updateObject(e,{transform:{...s.transform,width:r,height:n}})}},rotateObject:(e,r)=>{let{document:n}=t();if(n){let o=n.slides[t().currentSlideIndex].objects.find(t=>t.id===e);o&&o.transform&&t().updateObject(e,{transform:{...o.transform,angle:r}})}},setZoom:t=>{e({zoom:Math.max(.1,Math.min(5,t))})},setPan:t=>{e({pan:t})},saveToHistory:()=>{let{document:r,history:n}=t();r&&e({history:{past:[...n.past,r],future:[]}})},deleteSelectedObjects:()=>{let{document:r,selectedObjects:n}=t();if(r&&n.length>0){let o={...r},s=o.slides[t().currentSlideIndex];s.objects=s.objects.filter(e=>!n.includes(e.id)),e({document:o,selectedObjects:[]}),t().saveToHistory()}}}),{name:"pptx-editor-store"}));/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var v={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let j=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),w=(e,t)=>{let r=(0,s.forwardRef)(({color:r="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:i="",children:a,...c},d)=>(0,s.createElement)("svg",{ref:d,...v,width:n,height:n,stroke:r,strokeWidth:l?24*Number(o)/Number(n):o,className:["lucide",`lucide-${j(e)}`,i].join(" "),...c},[...t.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(a)?a:[a]]));return r.displayName=`${e}`,r},D=w("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),k=w("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);function S({onFileUpload:e,isLoading:t}){let[r,n]=(0,s.useState)(!1),l=(0,s.useRef)(null),i=(0,s.useCallback)(e=>{e.preventDefault(),n(!0)},[]),a=(0,s.useCallback)(e=>{e.preventDefault(),n(!1)},[]),c=(0,s.useCallback)(t=>{t.preventDefault(),n(!1);let r=Array.from(t.dataTransfer.files);r.length>0&&e(r[0])},[e]),d=(0,s.useCallback)(t=>{let r=Array.from(t.target.files||[]);r.length>0&&e(r[0])},[e]),u=(0,s.useCallback)(()=>{l.current?.click()},[]);return(0,o.jsxs)("div",{className:`
        relative border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors duration-200
        ${r?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"}
      `,onDragOver:i,onDragLeave:a,onDrop:c,onClick:u,children:[o.jsx("input",{ref:l,type:"file",accept:".pptx",onChange:d,className:"hidden"}),(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[t?o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mb-4"}):o.jsx(D,{className:"h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t?"Processing...":"Upload PowerPoint Presentation"}),o.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Drag and drop a .pptx file here, or click to browse"}),(0,o.jsxs)("div",{className:"flex items-center text-xs text-gray-400",children:[o.jsx(k,{className:"h-4 w-4 mr-1"}),"Supports .pptx files only"]})]})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let C=w("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]),P=w("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5v0A5.5 5.5 0 0 0 9.5 20H13",key:"19mnr4"}]]),N=w("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),E=w("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var T=r(4669);function $(){let{document:e,deleteSelectedObjects:t,canUndo:r,canRedo:n}=y(),s=async()=>{if(!e){T.toast.error("No presentation to export");return}try{T.toast.loading("Exporting PPTX...");let t=await l.exportPPTX(e),r=window.URL.createObjectURL(t),n=window.document.createElement("a");n.href=r,n.download=`${e.name||"presentation"}.pptx`,window.document.body.appendChild(n),n.click(),window.document.body.removeChild(n),window.URL.revokeObjectURL(r),T.toast.success("PPTX exported successfully!")}catch(e){console.error("Export error:",e),T.toast.error("Failed to export PPTX")}};return(0,o.jsxs)("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:e?.name||"PPTX Editor"})}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>{(0,T.toast)("Undo feature coming soon!",{icon:"\uD83D\uDD04"})},disabled:!r,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:"Undo",children:o.jsx(C,{size:20})}),o.jsx("button",{onClick:()=>{(0,T.toast)("Redo feature coming soon!",{icon:"\uD83D\uDD04"})},disabled:!n,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:"Redo",children:o.jsx(P,{size:20})}),o.jsx("button",{onClick:()=>{t(),T.toast.success("Selected objects deleted")},className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-md",title:"Delete Selected",children:o.jsx(N,{size:20})}),(0,o.jsxs)("button",{onClick:s,className:"inline-flex items-center px-4 py-2 bg-gray-800 text-white text-sm font-medium rounded-md hover:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[o.jsx(E,{size:16,className:"mr-2"}),"Export"]})]})]})}function O(){let{document:e,currentSlideIndex:t,setCurrentSlide:r}=y(),n=(0,s.useRef)([]),l=(0,s.useRef)(null);if((0,s.useEffect)(()=>{e&&e.slides&&(n.current=Array(e.slides.length).fill(null),console.log("\uD83D\uDD04 Initialized thumbnail refs array with length:",e.slides.length))},[e]),(0,s.useEffect)(()=>{if(console.log("\uD83D\uDD04 Auto-scroll effect triggered, currentSlideIndex:",t),console.log("\uD83D\uDD04 thumbnailRefs.current:",n.current),console.log("\uD83D\uDD04 containerRef.current:",l.current),t>=0&&n.current[t]){let e=n.current[t],r=l.current;if(console.log("\uD83D\uDD04 Active thumbnail found:",e),console.log("\uD83D\uDD04 Container found:",r),e&&r){let t=r.getBoundingClientRect(),n=e.offsetTop,o=e.offsetHeight;console.log("\uD83D\uDD04 Container dimensions:",t),console.log("\uD83D\uDD04 Thumbnail position:",{thumbnailTop:n,thumbnailHeight:o});let s=n-t.height/2+o/2;console.log("\uD83D\uDD04 Target scroll position:",s),console.log("\uD83D\uDD04 Current scroll position:",r.scrollTop),r.scrollTo({top:Math.max(0,s),behavior:"smooth"}),console.log("\uD83D\uDD04 Scrolling to:",Math.max(0,s))}else console.log("âŒ Missing thumbnail or container")}else console.log("âŒ Invalid slide index or thumbnail ref not found")},[t]),!e)return null;let i=(0,s.useCallback)(e=>{console.log("\uD83D\uDD04 Slide clicked, index:",e),console.log("\uD83D\uDD04 Current slide index before:",t),r(e),console.log("\uD83D\uDD04 setCurrentSlide called with:",e)},[r,t]),a=(0,s.useCallback)(()=>{alert("Add slide functionality coming soon!")},[]);return(0,o.jsxs)("div",{className:"w-64 bg-white border-r border-gray-200 p-4 overflow-y-auto",ref:l,children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Slides"}),o.jsx("button",{onClick:a,className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"+ Add"})]}),o.jsx("div",{className:"space-y-3",children:e.slides.map((e,r)=>o.jsx(X,{slide:e,index:r,isActive:r===t,onClick:()=>i(r),ref:e=>{e?(console.log(`ðŸ”„ Setting ref for slide ${r}:`,e),n.current[r]=e):(console.log(`ðŸ”„ Clearing ref for slide ${r}`),n.current[r]=null)}},e.id))})]})}let X=(0,s.forwardRef)(({slide:e,index:t,isActive:r,onClick:n},s)=>(0,o.jsxs)("div",{ref:s,className:`
          relative cursor-pointer rounded-lg border-2 transition-all duration-200 hover:shadow-md
          ${r?"border-primary-500 shadow-lg":"border-gray-200 hover:border-gray-300"}
        `,onClick:n,children:[(0,o.jsxs)("div",{className:"p-2",children:[(0,o.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["Slide ",t+1]}),o.jsx("div",{className:"bg-gray-100 rounded border border-gray-200 overflow-hidden",style:{width:"100%",height:"80px",aspectRatio:`${e.width} / ${e.height}`},children:o.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-500",children:e.objects.length>0?(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"font-medium",children:e.name}),(0,o.jsxs)("div",{children:[e.objects.length," objects"]})]}):(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"font-medium",children:"Empty Slide"}),o.jsx("div",{className:"text-gray-400",children:"No content"})]})})}),o.jsx("div",{className:"mt-1 text-xs text-gray-600 truncate",children:e.name})]}),r&&o.jsx("div",{className:"absolute inset-0 border-2 border-primary-500 rounded-lg pointer-events-none"})]}));X.displayName="SlideThumbnail";let R=null;function M(){let e=(0,s.useRef)(null),t=(0,s.useRef)(null),[n,l]=(0,s.useState)(!1),[i,a]=(0,s.useState)(!1),{document:c,currentSlideIndex:d,selectedObjects:u,zoom:f,pan:g,gridSnap:p,objectSnap:h,selectObjects:x,updateObject:m,moveObjects:b,resizeObject:v,rotateObject:j,setPan:w,saveToHistory:D}=y();(0,s.useEffect)(()=>{(async()=>{try{R=(await r.e(168).then(r.t.bind(r,1168,23))).fabric,a(!0)}catch(e){console.error("Failed to load Fabric.js:",e)}})()},[]),(0,s.useEffect)(()=>(e.current&&!t.current&&R&&i&&(t.current=new R.Canvas(e.current,{selection:!0,preserveObjectStacking:!0,backgroundColor:"#ffffff",enableRetinaScaling:!0,renderOnAddRemove:!0,selectionColor:"rgba(59, 130, 246, 0.3)",selectionBorderColor:"rgb(59, 130, 246)",selectionLineWidth:2,transparentCorners:!1,cornerColor:"rgb(59, 130, 246)",cornerStrokeColor:"white",cornerSize:10,cornerStyle:"circle",padding:5,skipTargetFind:!1,targetFindTolerance:5,perPixelTargetFind:!1,fireRightClick:!0,fireMiddleClick:!0,stopContextMenu:!1,allowTouchScrolling:!0,isDrawingMode:!1,imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}),t.current.on("selection:created",N),t.current.on("selection:updated",N),t.current.on("selection:cleared",E),t.current.on("object:modified",T),t.current.on("object:moving",$),t.current.on("object:scaling",O),t.current.on("object:rotating",X),t.current.on("text:changed",M),t.current.on("text:editing:exited",Y),t.current.on("mouse:down",e=>{e.target&&console.log("Object selected:",e.target.data)}),l(!0)),()=>{t.current&&(t.current.dispose(),t.current=null)}),[i]);let k=(0,s.useCallback)(e=>{try{if(console.log(`ðŸ” Extracting transform for object ${e.id}:`,e),console.log(`ðŸ” rawData structure:`,JSON.stringify(e.rawData,null,2)),!e.rawData)return console.warn(`Object ${e.id} has no rawData, using default transform`),{left:0,top:0,width:100,height:100,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1};let t=e.rawData["p:spPr"];if(console.log(`ðŸ” Found spPr:`,t),t&&t["a:xfrm"]){let e=t["a:xfrm"];console.log(`ðŸ” Found xfrm:`,e);let r=e["a:off"],n=e["a:ext"],o=e["a:rot"];console.log(`ðŸ” Found off:`,r),console.log(`ðŸ” Found ext:`,n),console.log(`ðŸ” Found rot:`,o);let s=1/12700,l=r&&r.$&&r.$.x?parseInt(r.$.x)*s:0,i=r&&r.$&&r.$.y?parseInt(r.$.y)*s:0,a=n&&n.$&&n.$.cx?parseInt(n.$.cx)*s:100,c=n&&n.$&&n.$.cy?parseInt(n.$.cy)*s:100,d=o&&o.$&&o.$.val?parseInt(o.$.val)/6e4:0;return console.log(`ðŸ” Calculated transform:`,{left:l,top:i,width:a,height:c,angle:d}),console.log(`ðŸ” Raw EMU values: x=${r?.$?.x}, y=${r?.$?.y}, cx=${n?.$?.cx}, cy=${n?.$?.cy}`),console.log(`ðŸ” Conversion factor: ${s}`),{left:Math.max(0,l),top:Math.max(0,i),width:Math.max(10,a),height:Math.max(10,c),angle:d,scaleX:1,scaleY:1,flipX:!1,flipY:!1}}if(""===t||!t){console.log(`ðŸ” spPr is empty, checking for placeholder info`);let t=e.rawData["p:nvSpPr"];if(t&&t["p:nvPr"]&&t["p:nvPr"]["p:ph"]){let e=t["p:nvPr"]["p:ph"],r=e.$&&e.$.type,n=e.$&&e.$.idx;if(console.log(`ðŸ” Found placeholder type: ${r}, idx: ${n}`),"title"===r)return{left:50,top:50,width:700,height:100,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1};if("subTitle"===r)return{left:50,top:200,width:700,height:80,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1};if("body"===r)return{left:50,top:300,width:700,height:250,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1};if("1"===n)return{left:50,top:200,width:700,height:80,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1};else if("2"===n)return{left:50,top:300,width:700,height:250,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1}}}return console.log(`ðŸ” No transform found, using default`),{left:0,top:0,width:100,height:100,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1}}catch(t){return console.error(`Error extracting transform for object ${e.id}:`,t),{left:0,top:0,width:100,height:100,angle:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1}}},[]),S=(0,s.useCallback)(async e=>{try{console.log("Creating Fabric.js object for:",e);let t=e.transform||k(e);console.log("Using transform:",t);let r={left:t.left,top:t.top,width:t.width,height:t.height,angle:t.angle,scaleX:t.scaleX,scaleY:t.scaleY,flipX:t.flipX,flipY:t.flipY,selectable:!0,evented:!0},n=e.type;switch("shape"===e.type&&e.text&&e.text.trim()&&(n="text",console.log(`Converting shape to text object: "${e.text}"`)),n){case"text":let o=e.style||{};return new R.Text(e.text||"Text",{...r,fontSize:o.fontSize||16,fill:o.color||"#000000",fontFamily:o.fontFamily||"Arial, sans-serif",textAlign:o.textAlign||"left",originX:"left",originY:"top"});case"image":if(e.src)return console.log("\uD83D\uDD0D Creating image object with src:",e.src),console.log("\uD83D\uDD0D Image src type:",typeof e.src),console.log("\uD83D\uDD0D Image src length:",e.src.length),new Promise(t=>{console.log("\uD83D\uDD0D Starting image loading with fabric.Image.fromURL"),R.Image.fromURL(e.src,e=>{console.log("âœ… Image loaded successfully:",e),e.set({...r,originX:"left",originY:"top"}),t(e)},{crossOrigin:"anonymous"})});return console.log("Creating placeholder for image without src"),new R.Rect({...r,fill:"#e0e0e0",stroke:"#999999",strokeWidth:2,originX:"left",originY:"top"});case"rectangle":return new R.Rect({...r,fill:"#f0f0f0",stroke:"#cccccc",strokeWidth:1,originX:"left",originY:"top"});case"ellipse":return new R.Ellipse({...r,fill:"#f0f0f0",stroke:"#cccccc",strokeWidth:1,originX:"left",originY:"top"});case"line":return new R.Line([0,0,t.width,t.height],{...r,stroke:"#000000",strokeWidth:2,originX:"left",originY:"top"});case"group":if(e.children&&e.children.length>0)try{let t=e.children.map(e=>S(e)).filter(Boolean),n=(await Promise.all(t)).filter(Boolean);if(n.length>0)return new R.Group(n,{...r,originX:"left",originY:"top"})}catch(e){console.error("Error creating group objects:",e)}return new R.Rect({...r,fill:"rgba(200, 200, 200, 0.3)",stroke:"#999999",strokeWidth:1,originX:"left",originY:"top"});case"shape":if(!(e.text&&e.text.trim()))return console.log("Creating rectangle from generic shape"),new R.Rect({...r,fill:"#f0f0f0",stroke:"#cccccc",strokeWidth:1,originX:"left",originY:"top"});{console.log("Creating text object from generic shape:",e.text);let t=e.style||{};return new R.Text(e.text,{...r,fontSize:t.fontSize||16,fill:t.color||"#000000",fontFamily:t.fontFamily||"Arial, sans-serif",textAlign:t.textAlign||"left",originX:"left",originY:"top"})}default:return console.warn(`Unknown object type: ${e.type}, creating fallback rectangle`),new R.Rect({...r,fill:"#ffcccc",stroke:"#ff0000",strokeWidth:2,originX:"left",originY:"top"})}}catch(t){return console.error("Failed to create editable object for:",e,t),null}},[k]),C=(0,s.useCallback)((e,r,n)=>{if(t.current&&R)try{R.loadSVGFromString(e,(e,o)=>{if(e&&e.length>0){let o=new R.Group(e,{left:0,top:0,selectable:!1,evented:!1,hasControls:!1,hasBorders:!1,lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,zIndex:0}),s=o.getBoundingRect();if(s.width>r||s.height>n){let e=r/s.width,t=n/s.height;o.scale(Math.min(e,t))}t.current.add(o),t.current.sendToBack(o),console.log("SVG background rendered successfully")}})}catch(e){console.error("Error rendering slide SVG:",e)}},[]),P=(0,s.useCallback)(()=>{if(!t.current||!c||!R)return;let e=c.slides[d];if(!e)return;console.log("Rendering slide:",e),console.log("Slide objects:",e.objects),t.current.clear();let r=Math.max(e.width,800),n=Math.max(e.height,600);t.current.setDimensions({width:r,height:n}),console.log("Canvas dimensions set to:",r,"x",n),e.svgContent&&(console.log("Rendering slide SVG background"),C(e.svgContent,r,n));let o=[...e.objects].sort((e,t)=>(e.zOrder||0)-(t.zOrder||0));(async()=>{for(let e=0;e<o.length;e++){let s=o[e];console.log(`Creating editable overlay object ${e+1}:`,s);try{let o=await S(s);if(o){let s=o.left||0,l=o.top||0,i=o.width||0,a=o.height||0;s<0&&o.set("left",0),l<0&&o.set("top",0),s+i>r&&o.set("left",Math.max(0,r-i)),l+a>n&&o.set("top",Math.max(0,n-a)),t.current.add(o),console.log(`Added editable object ${e+1} to canvas:`,o)}else console.warn("Failed to create editable object for:",s)}catch(t){console.error(`Error creating object ${e+1}:`,t)}}})(),t.current.bringToFront(),t.current.requestRenderAll(),console.log("Slide rendering completed")},[c,d,S,C]);(0,s.useEffect)(()=>{t.current&&c&&n&&(console.log("Slide changed, rendering new slide:",d),console.log("Current slide data:",c.slides[d]),P())},[c,d,n,P]),(0,s.useEffect)(()=>{t.current&&R&&(t.current.setZoom(f),t.current.absolutePan(new R.Point(g.x,g.y)))},[f,g]);let N=(0,s.useCallback)(()=>{t.current&&x(t.current.getActiveObjects().map(e=>e.data?.id).filter(Boolean))},[x]),E=(0,s.useCallback)(()=>{x([])},[x]),T=(0,s.useCallback)(()=>{t.current&&(t.current.getActiveObjects().forEach(e=>{e.data?.id&&m(e.data.id,{transform:{left:e.left||0,top:e.top||0,width:e.width||0,height:e.height||0,angle:e.angle||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1,flipX:e.flipX||!1,flipY:e.flipY||!1}})}),D())},[m,D]),$=(0,s.useCallback)(e=>{if(!t.current||!p)return;let r=e.target;r&&r.set({left:10*Math.round(r.left/10),top:10*Math.round(r.top/10)})},[p]),O=(0,s.useCallback)(e=>{if(!t.current)return;let r=e.target;r&&r.data?.id&&v(r.data.id,r.width||0,r.height||0)},[v]),X=(0,s.useCallback)(e=>{if(!t.current)return;let r=e.target;r&&r.data?.id&&j(r.data.id,r.angle||0)},[j]),M=(0,s.useCallback)(e=>{if(!t.current)return;let r=e.target;r&&r.data?.id&&m(r.data.id,{content:r.text})},[m]),Y=(0,s.useCallback)(e=>{if(!t.current)return;let r=e.target;r&&r.data?.id&&(m(r.data.id,{content:r.text}),D())},[m,D]),A=(0,s.useCallback)(e=>{t.current&&(1===e.button||0===e.button&&e.altKey)&&(t.current.isDragging=!0,t.current.selection=!1,t.current.defaultCursor="grab")},[]),_=(0,s.useCallback)(e=>{if(!t.current||!t.current.isDragging)return;let r=e.movementX,n=e.movementY;w({x:g.x+r,y:g.y+n})},[g,w]),I=(0,s.useCallback)(()=>{t.current&&(t.current.isDragging=!1,t.current.selection=!0,t.current.defaultCursor="default")},[]),U=(0,s.useCallback)(e=>{t.current&&(e.preventDefault(),e.ctrlKey?e.deltaY:w({x:g.x-e.deltaX,y:g.y-e.deltaY}))},[f,g,w]);if(!c)return null;let z=c.slides[d];return z?i?(0,o.jsxs)("div",{className:"flex-1 flex flex-col bg-gray-100 overflow-hidden",children:[o.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:o.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden border-2 border-gray-300",children:o.jsx("canvas",{ref:e,onMouseDown:A,onMouseMove:_,onMouseUp:I,onWheel:U,className:"block border border-gray-200",style:{minWidth:"800px",minHeight:"600px"}})})}),(0,o.jsxs)("div",{className:"bg-white border-t border-gray-200 px-4 py-2 text-sm text-gray-600",children:["Slide ",d+1," of ",c.slides.length," â€¢",z.width," \xd7 ",z.height," â€¢",z.objects.length," objects"]})]}):o.jsx("div",{className:"flex-1 flex flex-col bg-gray-100 overflow-hidden",children:o.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading editor..."})]})})}):null}function Y(){let[e,t]=(0,s.useState)(!1),{document:r,setDocument:n}=y(),i=async e=>{if(!e.name.endsWith(".pptx")){T.toast.error("Please upload a .pptx file");return}t(!0);try{let t=await l.parsePPTX(e);n(t),T.toast.success("PPTX file parsed successfully!")}catch(e){console.error("Error parsing file:",e),T.toast.error("Error parsing PPTX file. Please try again.")}finally{t(!1)}};return r?(0,o.jsxs)("div",{className:"h-screen flex flex-col bg-gray-100",children:[o.jsx($,{}),(0,o.jsxs)("div",{className:"flex-1 flex",children:[o.jsx(O,{}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:o.jsx(M,{})})]})]}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"PPTX Slide Editor"}),o.jsx(S,{onFileUpload:i,isLoading:e})]})})}function A(){return o.jsx("main",{className:"min-h-screen bg-gray-50",children:o.jsx(Y,{})})}},1342:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a,metadata:()=>i});var n=r(5036),o=r(2195),s=r.n(o);r(5023);var l=r(9636);let i={title:"PPTX Editor",description:"Edit PowerPoint presentations in your browser"};function a({children:e}){return n.jsx("html",{lang:"en",children:(0,n.jsxs)("body",{className:s().className,children:[e,n.jsx(l.x7,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#363636",color:"#fff"}}})]})})}},1136:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>s,__esModule:()=>o,default:()=>l});let n=(0,r(6843).createProxy)(String.raw`/Users/chukaezeoguine/Desktop/pptx-slide-editor/src/app/page.tsx`),{__esModule:o,$$typeof:s}=n,l=n.default},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,474],()=>r(6111));module.exports=n})();